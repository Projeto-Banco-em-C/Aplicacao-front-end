<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processamento de Código de Barras</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>

    <script>
        $(document).ready(function () {
            // Código de barras de exemplo
            var codigoBarras = "50190.00016 00000.000166 87008.273291 1 97510000015297";

            // Função para quebrar o código de barras em campos
            function quebrarCodigoBarras(codigo) {
                var campos = codigo.split(' ');
                return {
                    campo1: campos[0],
                    campo2: campos[1],
                    campo3: campos[2],
                    campo4: campos[3],
                    campo5: campos[4]
                };
            }

            // Função para extrair as informações dos campos
            function extrairInformacoes(campos) {
                // Extrai a parte após o ponto
                var agencia = campos.campo1.split('.')[1].substring(0, 4); // 0001
                var conta = campos.campo2.split('.')[1].substring(0, 5); // 00016
                var fatorVencimento = campos.campo5.substring(0, 4); // UUUU no campo5
                var valor = campos.campo5.substring(4); // VVVVVVVVVV no campo5
                return {
                    agencia: agencia,
                    conta: conta,
                    fatorVencimento: fatorVencimento,
                    valor: valor
                };
            }

            // Função para converter o fator de vencimento para uma data
            function converterFatorParaData(fator) {
                var dataBase = new Date(1997, 9, 7); // Data base: 07/10/1997
                dataBase.setDate(dataBase.getDate() + parseInt(fator));
                return dataBase.toLocaleDateString('pt-BR');
            }

            // Função para formatar o valor
            function formatarValor(valor) {
                var valorFormatado = (parseInt(valor) / 100).toFixed(2);
                return "R$ " + valorFormatado.replace(".", ",");
            }

            // Quebrar o código de barras
            var campos = quebrarCodigoBarras(codigoBarras);

            // Extrair informações
            var informacoes = extrairInformacoes(campos);

            // Converter data de vencimento
            var dataVencimento = converterFatorParaData(informacoes.fatorVencimento);

            // Formatar valor
            var valorFormatado = formatarValor(informacoes.valor);

            // Exibir as informações
            console.log("Agência: " + informacoes.agencia);
            console.log("Conta: " + informacoes.conta);
            console.log("Data de Vencimento: " + dataVencimento);
            console.log("Valor: " + valorFormatado);
        });
    </script>

</body>

</html>